<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<meta name="theme-color" content="#000000">
<title>Freekitlab — 자동화 · 로봇 솔루션 플랫폼</title>
<meta name="description" content="Freekitlab 소개 및 랜딩: 헤드라인·핵심약속·FAQ.">

<style>
/* =========================
   Design Tokens / Resets
   ========================= */
:root{
  --bg:#000; --fg:#fff; --muted:#d9d9d9; --accent:#5daaff;
  --surface:rgba(255,255,255,.08); --border:rgba(255,255,255,.18);
  --radius:16px; --radius-sm:12px; --shadow:0 12px 36px rgba(0,0,0,.6);
  --container:1120px;

  /* Typography scales */
  --font-base: clamp(15px, 1.7vw, 16.5px);
  --font-lead: clamp(16px, 2vw, 18px);
  --font-h1: clamp(28px, 7vw, 40px);
  --font-h1-hero: clamp(32px, 8.5vw, 56px);
  --font-h2: clamp(20px, 4.5vw, 26px);
  --font-h3: clamp(16px, 3.5vw, 18px);

  /* Touch target */
  --tap-min: 44px;

  /* Safe area paddings */
  --safe-top: env(safe-area-inset-top);
  --safe-right: env(safe-area-inset-right);
  --safe-bottom: env(safe-area-inset-bottom);
  --safe-left: env(safe-area-inset-left);
}

*{box-sizing:border-box}
html{scroll-behavior:smooth}
html,body{height:100%}
body{
  margin:0;
  padding-top: 80px;
  font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Noto Sans KR, Apple SD Gothic Neo, Arial, sans-serif;
  background:#000; color:#fff;
  font-size: var(--font-base);
  line-height: 1.7;
  -webkit-text-size-adjust: 100%;
  -webkit-tap-highlight-color: rgba(255,255,255,0);
}
img{max-width:100%; height:auto; display:block}
a{color:#fff; text-decoration:none}
:focus-visible{outline: 2px solid #9ec5ff; outline-offset: 2px}
.container{max-width: var(--container); margin: 0 auto; padding: 0 20px}

/* Background canvas */
#canvas{position:fixed; inset:0; z-index:-1; opacity:.5;}

/* =========================
   Header / Navigation
   ========================= */
.site-header{
  position: fixed; top: 0; left: 0; right: 0; z-index: 100;
  background: rgba(0,0,0,.95); backdrop-filter: blur(10px);
  border-bottom:1px solid var(--border);
  padding-top: max(8px, var(--safe-top));
  width: 100%;
}
.header-bar{
  display:flex; align-items:center; justify-content:space-between;
  gap:12px; padding: 10px 20px;
}
.brand{
  font-weight: 900; letter-spacing:.3px;
  font-size: clamp(18px, 4.5vw, 22px);
  line-height: 1; padding: 6px 4px;
}

/* Desktop nav */
.nav{display:flex; align-items:center; gap: 6px;}
.nav a{
  display:inline-flex; align-items:center; justify-content:center;
  min-height: var(--tap-min);
  padding: 10px 14px; border-radius: 10px;
  color: var(--muted); font-weight: 700; letter-spacing:.2px;
}
.nav a:hover{ color:#fff; background: rgba(255,255,255,.08) }

/* Mobile nav button */
.nav-toggle{
  display:none; align-items:center; justify-content:center;
  min-width: var(--tap-min); min-height: var(--tap-min);
  padding: 10px; border-radius: 12px; border: 1px solid var(--border);
  background: transparent; color: #fff; cursor: pointer;
}
.nav-toggle[aria-expanded="true"]{background: rgba(255,255,255,.12)}
@media (max-width: 900px){
  .nav{display:none}
  .nav-toggle{display:inline-flex}
}

/* Mobile nav drawer */
.mobile-nav{display:none; border-top:1px solid var(--border); background: rgba(0,0,0,.7); backdrop-filter: blur(6px);}
.mobile-nav a{
  display:block; padding: 14px 20px; min-height: var(--tap-min);
  border-bottom:1px solid var(--border); color: var(--muted); font-weight: 700;
}
.mobile-nav a:last-child{border-bottom:0}
.mobile-nav a:hover{ color:#fff; background: rgba(255,255,255,.08) }

/* =========================
   Hero
   ========================= */
.hero{
  min-height: calc(100svh - 80px);
  display:flex; align-items:center; justify-content:center;
  text-align:left; padding: 0 20px;
  padding-bottom: max(20px, var(--safe-bottom));
}
.hero-inner{max-width: 920px; margin: 0 auto}
.h-title{margin:0 0 10px; font-size: var(--font-h1-hero); font-weight: 900; line-height: 1.15;}
.h-sub{margin:0 0 20px; color:#e6e6e6; font-size: var(--font-lead);}
.h-cta{display:flex; gap: 12px; flex-wrap:wrap; justify-content:center}
.btn{
  display:inline-flex; align-items:center; justify-content:center;
  min-height: var(--tap-min); padding: 14px 18px; border-radius: 14px; border:1px solid #fff;
  font-weight: 800; letter-spacing:.2px;
  font-size: var(--font-base);
  white-space: nowrap;
  transition: transform .15s ease, background .15s ease, color .15s ease;
}
.btn:hover{ transform: translateY(-1px); background:#fff; color:#000 }
.btn.secondary{ border-color: var(--accent); }
.btn.secondary:hover{ background: var(--accent); color:#000 }

/* =========================
   Intro band (profile)
   ========================= */
.band{border-top:1px solid var(--border); border-bottom:1px solid var(--border);
  background: radial-gradient(1200px 240px at 50% 0%, rgba(93,170,255,.22), transparent 60%);}
.intro{
  display:grid; grid-template-columns: 1.1fr .9fr; gap: 24px; align-items:center;
  padding: 42px 0;
}
.intro h2{ margin: 0 0 6px; font-size: var(--font-h2) }
.intro .lead{ margin:0; color:#dcdcdc; font-size: var(--font-lead) }
.profile{
  width: min(320px, 85vw); aspect-ratio: 1/1;
  margin-left: auto; margin-right: 0;
  border-radius: 50%; overflow: hidden;
  border: 2px solid var(--accent); box-shadow: var(--shadow);
}
.tree-image{
  width: min(400px, 85vw);
  margin-left: auto; margin-right: 0;
  border-radius: 0; overflow: visible;
  border: none; box-shadow: none;
  position: relative;
}
.tree-image img{
  width: 100%;
  height: auto;
  display: block;
  mix-blend-mode: screen;
  filter: brightness(1.05) contrast(1.1);
  opacity: 0.95;
}
@media (max-width: 900px){
  .intro{ grid-template-columns: 1fr; text-align: center }
  .profile{ margin: 16px auto 0 }
  .tree-image{ margin: 16px auto 0 }
}

/* =========================
   Sections / Layout
   ========================= */
.section{ padding: 56px 0; border-top: 1px solid var(--border) }
.section h2{ font-size: var(--font-h2); margin: 0 0 10px }
.section .sub{ margin: 0 0 20px; color: #d0d0d0; font-size: var(--font-lead) }

.features{ display:grid; grid-template-columns: repeat(3, minmax(0,1fr)); gap: 14px; }
.card{
  background: var(--surface); border: 1px solid var(--border);
  border-radius: var(--radius); padding: 18px; box-shadow: var(--shadow);
  transition: transform .2s ease, border-color .2s ease;
}
.card:hover{ transform: translateY(-2px); border-color: #5daaff }
.card h3{ margin: 0 0 8px; font-size: var(--font-h3) }
.badge{
  display:inline-flex; align-items:center; justify-content:center;
  padding: 6px 10px; min-height: var(--tap-min);
  border: 1px solid var(--border); border-radius: 999px; color: #bbb;
  font-size: clamp(11px, 2.5vw, 12px); margin-bottom: 8px;
}

.mock{ margin-top: 12px; border: 1px dashed rgba(255,255,255,.35); border-radius: 12px; padding: 10px;
  background: linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.02)); }
.mock .bar{ height: 10px; border-radius: 6px; background: rgba(255,255,255,.2); margin-bottom: 10px }
.mock .row{ display:grid; grid-template-columns: 2fr 1fr; gap: 8px; margin-bottom: 8px }
.mock .box{ height: 46px; border-radius: 10px; background: rgba(255,255,255,.1) }
.mock .grid{ display:grid; grid-template-columns: repeat(3,1fr); gap: 8px }
.mock .tile{ height: 60px; border-radius: 10px; background: rgba(255,255,255,.12) }

@media (max-width: 900px){
  .features{ grid-template-columns: 1fr }
}

/* Steps */
.steps{ display:grid; grid-template-columns: repeat(3, minmax(0,1fr)); gap: 14px; }
.step{
  background:var(--surface); border:1px solid var(--border); border-radius: var(--radius);
  padding: 16px; position: relative;
}
.step:before{
  content:""; position:absolute; left:-1px; right:-1px; top:-1px; height:3px;
  border-top-left-radius: var(--radius); border-top-right-radius: var(--radius);
  background: linear-gradient(90deg, #5daaff, #9ae6ff);
}
.step h4{ margin: 0 0 6px; font-size: var(--font-h3) }
@media (max-width: 900px){
  .steps{ grid-template-columns: 1fr }
}

/* FAQ */
.faq{ display:grid; grid-template-columns: 1fr; gap: 10px }
.faq details{
  background: var(--surface); border: 1px solid var(--border);
  border-radius: var(--radius-sm); padding: 12px;
}
.faq summary{
  cursor: pointer; font-weight: 900; min-height: var(--tap-min);
  display:flex; align-items:center;
}

/* Table (KPI) */
.table-wrap{ overflow:auto; border-radius: 12px; border:1px solid var(--border); background:var(--surface) }
table{ width:100%; border-collapse: collapse; font-variant-numeric: tabular-nums }
th,td{ padding: 12px 14px; border-bottom:1px solid var(--border) }
thead th{ background: rgba(255,255,255,.08); color:#bdbdbd; text-align:left; position: sticky; top: 0 }
tbody tr:nth-child(odd){ background: rgba(255,255,255,.04) }
tbody tr:hover{ background: rgba(255,255,255,.08) }

/* Final CTA */
.final{ padding: 52px 20px; border-top:1px solid var(--border); text-align:center }
.final .big{ font-size: clamp(22px, 6vw, 28px); margin: 0 0 8px; line-height: 1.35 }
.final .desc{ margin: 0 0 18px; color: #d6d6d6; font-size: var(--font-lead) }
.final-actions{
  display:flex; gap: 12px; flex-wrap:wrap; justify-content:center;
}
.final .cta{
  display:inline-flex; align-items:center; justify-content:center;
  min-height: var(--tap-min); padding: 14px 20px;
  border-radius: 14px; border:1px solid #fff; font-weight: 900;
  font-size: var(--font-base);
  white-space: nowrap;
  transition: transform .15s ease, background .15s ease, color .15s ease;
}
.final .cta:hover{ transform: translateY(-1px); background:#fff; color:#000 }
.final .cta.secondary{ border-color: var(--accent); }
.final .cta.secondary:hover{ background: var(--accent); color:#000 }

/* Footer */
footer{
  max-width: var(--container); margin: 0 auto; padding: 36px 20px;
  border-top:1px solid var(--border); color:#cfcfcf; text-align:center;
  padding-bottom: max(36px, var(--safe-bottom));
}
small a{ color:#9ec5ff }

/* =========================
   Contact Modal (30초 상담)
   ========================= */
.modal{
  position: fixed; inset: 0; z-index: 50; display: none;
  align-items: center; justify-content: center;
  padding: 20px; background: rgba(0,0,0,.6); backdrop-filter: blur(4px);
}
.modal[open]{ display: flex; }
.modal-card{
  width: min(620px, 96vw);
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 16px;
  box-shadow: var(--shadow);
  padding: 18px;
  color: var(--fg);
}
.modal-header{
  display:flex; align-items:center; justify-content:space-between; gap:12px; margin-bottom: 8px;
}
.modal-title{ font-size: var(--font-h2); margin: 0; }
.modal-close{
  min-width: var(--tap-min); min-height: var(--tap-min);
  border: 1px solid var(--border); border-radius: 12px; background: transparent; color: #fff; cursor: pointer;
}
.form{ display:grid; grid-template-columns: 1fr 1fr; gap: 12px; }
.form .full{ grid-column: 1 / -1; }
label{ display:block; font-weight: 800; margin: 6px 0; }
input, textarea{
  width: 100%; color: #fff; background: rgba(255,255,255,.06);
  border: 1px solid var(--border); border-radius: 12px;
  padding: 12px 14px; line-height: 1.6; font-size: 16px;
}
textarea{ min-height: 110px; resize: vertical; }
.helper{ color: #bdbdbd; font-size: 13px; margin-top: 2px; }
.form-actions{ display:flex; gap: 10px; justify-content:flex-end; margin-top: 6px; }
.form button{
  min-height: var(--tap-min); padding: 12px 16px; border-radius: 12px; border: 1px solid #fff; background: transparent; color: #fff; font-weight: 900; cursor: pointer;
}
.form button.primary{ background: #fff; color: #000; border-color: #fff; }
.form button.secondary{ border-color: var(--accent); }
@media (max-width: 720px){
  .form{ grid-template-columns: 1fr; }
}

/* Toast */
.toast{
  position: fixed; left: 50%; bottom: max(16px, var(--safe-bottom));
  transform: translateX(-50%);
  background: #111; color: #fff; border: 1px solid var(--border); border-radius: 10px;
  padding: 10px 14px; box-shadow: var(--shadow);
  opacity: 0; pointer-events: none; transition: opacity .2s ease;
  z-index: 60;
}
.toast.show{ opacity: 1; }
</style>
</head>
<body>

<!-- Background (optional animated tubes via JS) -->
<canvas id="canvas" aria-hidden="true"></canvas>

<!-- Header -->
<header class="site-header" role="banner">
  <div class="header-bar container">
    <div class="brand">Freekitlab</div>

    <!-- Desktop nav -->
    <nav class="nav" aria-label="주요">
      <a href="#features">핵심약속</a>
      <a href="#process">도입절차</a>
      <a href="#faq">FAQ</a>
      <a href="#cta">문의</a>
    </nav>

    <!-- Mobile nav toggle -->
    <button class="nav-toggle" aria-label="메뉴 열기" aria-controls="mobile-nav" aria-expanded="false">
      <svg width="24" height="24" viewBox="0 0 24 24" role="img" aria-hidden="true" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M3 6h18M3 12h18M3 18h18"/>
      </svg>
    </button>
  </div>

  <!-- Mobile nav drawer -->
  <nav id="mobile-nav" class="mobile-nav" aria-label="모바일 메뉴">
    <a href="#features">핵심약속</a>
    <a href="#process">도입절차</a>
    <a href="#faq">FAQ</a>
    <a href="#cta">문의</a>
  </nav>
</header>

<!-- Hero -->
<section class="hero" id="top">
  <div class="hero-inner container" role="region" aria-labelledby="hero-title">
    <h1 id="hero-title" class="h-title">자동화장비/로봇 판매 플랫폼</h1>
    <p class="h-sub">
      <br>
      모든 장비를 하나의 플랫폼에서 관리하세요.<br>
      자동화 장비/로봇에 대한 정부지원금 정보를 제공합니다.<br>
      국내외 첨단 솔루션에 대해 무료 상담 받고 특가 혜택을 누리십시오.<br>
      프리킷랩은 구매한 장비에 대해서 폐업시까지 함께합니다.<br>
      <br>
    </p>
    <div class="h-cta">
      <a class="btn" href="#features">핵심약속 보기</a>
      <!-- 변경: 버튼을 모달 오픈으로 전환 -->
      <button id="open-contact" class="btn secondary" type="button" aria-haspopup="dialog" aria-controls="contact-modal">컨설팅 신청</button>
    </div>
  </div>
</section>

<!-- Intro (Profile) -->
<div class="band">
  <section class="intro container" aria-labelledby="intro-title">
    <div>
      <h2 id="intro-title">비전 & 미션</h2>
      <p class="lead">사장님이 로봇을 경영하고 가게에 묶여있지 않는 세상을 꿈꿉니다. 정보의 비대칭을 해결하기 위하여, 첨단 솔루션을 수집하고 판매경로를 연결하며, 고객의 페인포인트를 찾아 해결합니다.</p>
    </div>
    <div class="tree-image">
      <img src="/images/나노바나나 검은색배경나무.png" alt="" loading="lazy" decoding="async">
    </div>
  </section>
</div>

<!-- Core Features -->
<section id="features" class="section container" aria-labelledby="features-title">
  <h2 id="features-title">핵심약속</h2>
  <p class="sub">아낌없이 주는 나무를 표방합니다. 수수료 없는 해외직구 무료상담 서비스를 제공합니다. <br>
    폐업시 프리킷랩에서 구매한 중고장비에 대한 중개판매 채널을 제공합니다. <br>
     </p>

  <div class="features">
    <article class="card" aria-labelledby="f1">
      <span class="badge" aria-hidden="true">해외직구 무료 상담</span>
      <h3 id="f1">가성비 솔루션 보급에 대한 집착</h3>
      <ul>
        <li>해외 솔루션 수집 및 전파</li>
        <li>해외장비 KC 인증 문제에 대한 도움</li>
        <li>국내외 솔루션별 비교 및 추천</li>
      </ul>
    </article>

    <article class="card" aria-labelledby="f2">
      <span class="badge" aria-hidden="true">중고장비 처리와 구매</span>
      <h3 id="f2">투자비 절감과 리스크 고민</h3>
      <ul>
        <li>폐업시 프리킷 구매장비 중개판매</li>
        <li>양질의 중고장비 판매, 투자비절감</li>
        <li>최대할인폭 제시</li>
      </ul>
    </article>

    <article class="card" aria-labelledby="f3">
      <span class="badge" aria-hidden="true">무료 정부지원금 컨설팅</span>
      <h3 id="f3">정부지원금의 높은 문턱해소</h3>
      <ul>
        <li>무료 정부지원 사업 홍보</li>
        <li>정부지원사업 진행절차 가이드</li>
        <li>지원금 유관 장비 판매</li>
      </ul>
    </article>
  </div>
</section>

<!-- Process -->
<section id="process" class="section container" aria-labelledby="process-title">
  <h2 id="process-title">도입절차</h2>
  <p class="sub">첫 상담부터 설치, 든든한 사후관리까지. 프리킷랩이 '동반자'가 되어 전 과정을 함께합니다.</p>
  <div class="steps">
    <div class="step">
      <h4>1:1 맞춤 컨설팅</h4>
      <p>1) 업종, 매장 및 인력 기반 정밀 진단<br>
      2) 최저가 비교 및 가성비 솔루션 추천<br>
      3) 복수장비 구매 추가할인 여부 확인<br>
    </p>
    </div>
    <div class="step">
      <h4>사용자 옵션 선택</h4>
      <p>1) 거품없는 견적제공 및 확인<br>
        2) 결제옵션 확인(구매/렌탈)<br>
        3) 정부지원금 연계검토 및 구매확정<br>
      </p>
    </div>
    <div class="step">
      <h4>든든한 사후관리</h4>
      <p>1) 메뉴얼에 따른 장비설치<br>
        2) 원격 모니터링 및 신속한 AS 지원<br>
        3) 폐업시 중고장비 처리 지원<br>
      </p>
    </div>
  </div>
</section>

<!-- FAQ -->
<section id="faq" class="section container" aria-labelledby="faq-title">
  <h2 id="faq-title">FAQ</h2>
  <div class="faq">
    <details open>
      <summary>정부 지원금 상담도 해주나요?</summary>
      <p>네. 스마트상점/자동화 보조금 등 적합 사업을 매칭하고 신청·서류 작성 가이드를 제공합니다. 프리킷랩과의 거래여부와 관계 없이 사장님의 성공을 지원합니다. 성공사례는 향후 공개될 수도 있습니다.</p>
    </details>
    <details open>
      <summary>중고장비 처리는 어떻게 작동하나요?</summary>
      <p>제조사와 공동부담 정책 합의 시 '중고 매입보장' Tag를 부여합니다. 중고 매입에 대한 정책은 제조사별로 다를 수 있습니다. 이와 별개로 프리킷랩에서 중고장비 판매 플랫폼을 운영하며, 판매장비에 대해서는 최저 수수료로 중개판매합니다.</p>
    </details>
    <details open>
      <summary>컨설턴트 양성 및 지원은 어떻게 하나요?</summary>
      <p>자영업자를 포함해서(투잡) 누구나 지원 가능합니다. 솔루션 교육은 추가로 진행되며, 최고의 대우를 약속합니다 </p>
    </details>
  </div>
</section>

<!-- Final CTA -->
<section id="cta" class="final" aria-labelledby="cta-title">
  <h2 id="cta-title" class="big">사장님의 '로봇 경영' 첫걸음, 오늘 시작하세요.</h2>
  <p class="desc">투자 및 운영분석, 정부지원금, 중고처리 옵션까지, 한 번에 설계해 드립니다.</p>
  <!-- 동일 CTA 버튼도 모달로 연결 -->
  <div class="final-actions">
    <button class="cta" id="open-contact-2" type="button" aria-haspopup="dialog" aria-controls="contact-modal">컨설팅 신청하기</button>
    <button class="cta secondary" type="button">컨설턴트 지원문의</button>
  </div>
</section>

<footer role="contentinfo">
  <small>© <span id="year"></span> Freekitlab · <a href="#top">맨 위로</a></small>
</footer>

<!-- ========== Contact Modal (메일 전송: mailto) ========== -->
<dialog class="modal" id="contact-modal" aria-labelledby="contact-title" aria-modal="true">
  <div class="modal-card" role="document">
    <div class="modal-header">
      <h3 id="contact-title" class="modal-title">컨설팅 신청</h3>
      <button class="modal-close" id="close-contact" type="button" aria-label="닫기">✕</button>
    </div>

    <!-- 간단한 문의 폼 (정적 페이지용) -->
    <form id="contact-form" class="form" autocomplete="on">
      <!-- honeypot (스팸 봇 방지) -->
      <input type="text" name="company" id="hp-company" style="position:absolute;left:-9999px" tabindex="-1" aria-hidden="true">

      <div>
        <label for="name">이름</label>
        <input id="name" name="name" type="text" inputmode="text" placeholder="홍길동" required>
      </div>
      <div>
        <label for="phone">연락처</label>
        <input id="phone" name="phone" type="tel" inputmode="tel" placeholder="010-1234-5678" required>
      </div>

      <div class="full">
        <label for="email">이메일 (선택)</label>
        <input id="email" name="email" type="email" inputmode="email" placeholder="you@example.com">
        <p class="helper">선택 사항입니다.</p>
      </div>

      <div class="full">
        <label for="msg">문의내용 (선택)</label>
        <textarea id="msg" name="msg" placeholder="관심 장비/매장 규모/예산 등 간단히 적어주세요."></textarea>
      </div>

      <div class="form-actions full">
        <button class="primary" type="submit">제출하기</button>
      </div>
    </form>
  </div>
</dialog>

<!-- Toast -->
<div id="toast" class="toast" role="status" aria-live="polite"></div>

<script type="module">
/* Mobile nav toggle */
const toggle = document.querySelector('.nav-toggle');
const mnav  = document.getElementById('mobile-nav');
if (toggle && mnav){
  toggle.addEventListener('click', ()=>{
    const exp = toggle.getAttribute('aria-expanded') === 'true';
    toggle.setAttribute('aria-expanded', String(!exp));
    mnav.style.display = exp ? 'none' : 'block';
    toggle.setAttribute('aria-label', exp ? '메뉴 열기' : '메뉴 닫기');
  });
}

/* Background (optional): Tubes Cursor; graceful fallback on WebGL-less devices */
const cvs = document.getElementById('canvas');
try{
  const TubesCursor = (await import("https://cdn.jsdelivr.net/npm/threejs-components@0.0.19/build/cursors/tubes1.min.js")).default;
  const app = TubesCursor(cvs, {
    tubes:{ colors:["#5daaff","#9ae6ff","#ffffff"], lights:{ intensity:200, colors:["#aabfff","#9ae6ff","#ffffff"] } }
  });
  function rc(n){return Array.from({length:n},()=>"#"+Math.floor(Math.random()*16777215).toString(16).padStart(6,"0"))}
  document.body.addEventListener('click',()=>{const c=rc(3),l=rc(4);app.tubes.setColors(c);app.tubes.setLightsColors(l);});
}catch(e){ if (cvs) cvs.style.display = 'none'; }

/* Footer year */
document.getElementById('year').textContent = new Date().getFullYear();

/* ========= Contact Modal logic ========= */
const modal = document.getElementById('contact-modal');
const open1 = document.getElementById('open-contact');
const open2 = document.getElementById('open-contact-2');
const closeBtn = document.getElementById('close-contact');
const form = document.getElementById('contact-form');
const toast = document.getElementById('toast');
const hp = document.getElementById('hp-company');

function showModal(){
  if ('showModal' in modal) modal.showModal(); else modal.setAttribute('open','');
  setTimeout(()=>document.getElementById('name')?.focus(), 50);
}
function closeModal(){
  if ('close' in modal) modal.close(); else modal.removeAttribute('open');
}
open1?.addEventListener('click', showModal);
open2?.addEventListener('click', showModal);
closeBtn?.addEventListener('click', closeModal);
modal?.addEventListener('click', (e)=>{
  // click outside to close
  const rect = e.currentTarget.querySelector('.modal-card')?.getBoundingClientRect();
  if (!rect) return;
  const inDialog = e.clientX >= rect.left && e.clientX <= rect.right && e.clientY >= rect.top && e.clientY <= rect.bottom;
  if (!inDialog) closeModal();
});

/* Form submit - 서버에 저장 */
form?.addEventListener('submit', async (e)=>{
  e.preventDefault();
  // honeypot check
  if (hp?.value?.trim()) { showToast('스팸 의심 제출은 차단되었습니다.'); return; }

  const name  = (document.getElementById('name').value || '').trim();
  const phone = (document.getElementById('phone').value || '').trim();
  const email = (document.getElementById('email').value || '').trim();
  const msg   = (document.getElementById('msg').value || '').trim();

  // 필수 항목 확인
  if (!name || !phone) {
    showToast('이름과 연락처는 필수입니다.');
    return;
  }

  try {
    showToast('제출 중...');
    
    const requestData = {
      name: name,
      phone: phone,
      email: email,
      message: msg
    };
    
    console.log('[클라이언트] 전송할 데이터:', requestData);
    
    const response = await fetch('/api/consultation', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'Accept': 'application/json',
      },
      body: JSON.stringify(requestData)
    });
    
    console.log('[클라이언트] 응답 상태:', response.status, response.statusText);
    console.log('[클라이언트] 응답 Headers:', Object.fromEntries(response.headers.entries()));
    
    // 응답 상태 확인
    if (!response.ok) {
      let errorData;
      try {
        const text = await response.text();
        console.log('[클라이언트] 응답 본문:', text);
        errorData = JSON.parse(text);
      } catch (e) {
        console.error('[클라이언트] JSON 파싱 실패:', e);
        errorData = { message: `서버 오류 (${response.status}): ${response.statusText}` };
      }
      showToast(errorData.message || `오류 (${response.status})`);
      console.error('[클라이언트] Server error:', response.status, errorData);
      return;
    }
    
    const result = await response.json();
    console.log('[클라이언트] 성공 응답:', result);
    
    if (result.status === 'success') {
      showToast('접수되었습니다! 빠른 시일 내에 연락드리겠습니다.');
      closeModal();
      document.getElementById('contact-form').reset();
    } else {
      showToast(result.message || '오류가 발생했습니다.');
    }
    
  } catch(err) {
    console.error('[클라이언트] Network error:', err);
    showToast(`연결 오류: ${err.message}. 서버가 실행 중인지 확인해주세요.`);
  }
});

/* Toast helper */
let toastTimer = null;
function showToast(message){
  toast.textContent = message;
  toast.classList.add('show');
  clearTimeout(toastTimer);
  toastTimer = setTimeout(()=>toast.classList.remove('show'), 2800);
}
</script>
</body>
</html>

